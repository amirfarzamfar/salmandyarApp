برنامه به‌روزرسانی‌شده شامل پیاده‌سازی کامل در بک‌اند و فرانت‌اند، و افزودن گزینه «مدیریت کاربران» به نوار کناری پنل ادمین است.

### ۱. بک‌اند (Backend) - زیرساخت و API

#### الف) تغییرات دیتابیس (Domain & Persistence)
1.  **به‌روزرسانی `User`**:
    -   افزودن `NationalCode` (کد ملی) برای جستجو.
    -   افزودن `IsActive`, `BanReason` برای مدیریت وضعیت.
    -   افزودن `LastLoginDate`, `LastLoginIp` برای امنیت و گزارش‌گیری.
    -   افزودن `AdminNotes` (یادداشت‌های ادمین روی کاربر).
2.  **ایجاد `AuditLog`**: جدول اختصاصی برای ثبت تمام تغییرات اعمال شده توسط ادمین (چه کسی، چه زمانی، چه چیزی را تغییر داد).

#### ب) سرویس‌ها (Application & Infrastructure)
1.  **`UserManagementService`**:
    -   جستجو بر اساس نام، ایمیل، موبایل و کد ملی.
    -   فیلتر بر اساس نقش (پزشک، پرستار، بیمار، ادمین) و وضعیت (فعال/مسدود).
    -   تغییر نقش و وضعیت کاربر.
    -   عملیات گروهی (Bulk Actions).
2.  **`AuditLogService`**: ثبت خودکار لاگ هنگام انجام عملیات حساس.

#### ج) کنترلرها (API Layer)
-   `GET /api/admin/users`: لیست با فیلتر و صفحه‌بندی.
-   `GET /api/admin/users/{id}`: جزئیات کامل + لاگ‌ها.
-   `PATCH /api/admin/users/{id}/status`: مسدود/فعال‌سازی.
-   `PATCH /api/admin/users/{id}/role`: تغییر نقش.
-   `POST /api/admin/users/{id}/reset-password`: ریست پسورد.

### ۲. فرانت‌اند (Frontend) - پنل ادمین

#### الف) نوار کناری (`Sidebar.tsx`)
-   افزودن آیتم جدید **«مدیریت کاربران»** با آیکون مناسب به منوی ناوبری که به مسیر `/dashboard/admin/users` هدایت می‌کند.

#### ب) صفحه مدیریت کاربران (`/dashboard/admin/users`)
1.  **جدول پیشرفته کاربران**:
    -   نمایش لیست کاربران با ستون‌های: نام، نقش، موبایل، وضعیت، آخرین ورود.
    -   قابلیت جستجو (Search Bar) و فیلترهای دراپ‌داون (نقش، وضعیت).
    -   صفحه‌بندی (Pagination) سمت سرور.
2.  **دیالوگ جزئیات و ویرایش**:
    -   نمایش پروفایل کامل.
    -   تب «امنیت»: تغییر رمز عبور، مشاهده آخرین IP.
    -   تب «تاریخچه»: مشاهده لاگ تغییرات (Audit Log).
3.  **مدیریت وضعیت**:
    -   دکمه‌های تغییر وضعیت (فعال/مسدود) با قابلیت ثبت دلیل مسدودسازی.

### ۳. گام‌های اجرایی

1.  **Backend**: اعمال تغییرات روی Entityها و دیتابیس (Migration).
2.  **Backend**: پیاده‌سازی سرویس و کنترلر `UsersController`.
3.  **Frontend**: افزودن لینک به سایدبار و ساخت صفحه مدیریت کاربران.
4.  **Frontend**: اتصال صفحه به API و تست نهایی.

این برنامه هم نیازمندی‌های فنی (امنیت، لاگ) و هم نیازمندی‌های رابط کاربری (منو، جدول پیشرفته) را پوشش می‌دهد. آیا تأیید می‌کنید؟