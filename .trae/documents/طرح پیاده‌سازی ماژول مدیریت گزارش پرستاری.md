# طرح پیاده‌سازی ماژول مدیریت گزارش پرستاری

این طرح شامل ایجاد ساختار داده‌ای جدید برای مدیریت داینامیک آیتم‌های گزارش و رابط کاربری مربوطه است.

## ۱. بک‌اند (ASP.NET Core)

### الف) لایه Domain (Entity ها)
ما نیاز به موجودیت‌های جدیدی برای تعریف ساختار گزارش داریم:
1.  **`ReportCategory`**: دسته‌بندی‌های اصلی (مثل "سیستم تنفسی").
    *   Properties: `Id`, `Title`, `Order`, `IsActive`
2.  **`ReportItem`**: آیتم‌های قابل چک کردن (مثل "اکسیژن تراپی").
    *   Properties: `Id`, `CategoryId`, `Title`, `DefaultValue` (متن پیش‌فرض), `ParentId` (برای زیر‌دسته‌ها), `Order`, `IsActive`
3.  **`NursingReportDetail`**: برای ذخیره آیتم‌های انتخاب شده در هر گزارش (جهت گزارش‌گیری دقیق‌تر در آینده).
    *   Properties: `ReportId`, `ItemId`, `Value` (متن نهایی ثبت شده), `IsChecked`

### ب) لایه Application (DTOs & Services)
1.  **DTOs**:
    *   `ReportCategoryDto`, `CreateReportCategoryDto`
    *   `ReportItemDto`, `CreateReportItemDto`
    *   `SubmitNursingReportDto` (شامل لیست آیتم‌های انتخاب شده)
2.  **Services**:
    *   **`IReportConfigurationService`**: مدیریت CRUD برای دسته‌ها و آیتم‌ها.
    *   **`INursingReportService`**:
        *   متد `GenerateReportText`: تبدیل آیتم‌های انتخاب شده به یک متن روان و پیوسته.
        *   متد `CreateReport`: ذخیره گزارش و جزئیات آن.

### ج) لایه API (Controllers)
1.  **`ReportConfigurationController`**: اندپوینت‌های مدیریت دسته‌ها و آیتم‌ها (Admin).
2.  **`NursingReportsController`**: اندپوینت‌های ثبت و دریافت گزارش‌ها.

---

## ۲. فرانت‌اند (Next.js)

### الف) پنل ادمین (مدیریت پیکربندی)
یک صفحه جدید در داشبورد برای مدیریت ساختار گزارش‌ها:
*   **مسیر**: `/dashboard/admin/report-config`
*   **کامپوننت‌ها**:
    *   `CategoryList`: لیست دسته‌ها با قابلیت Drag & Drop (اختیاری) یا دکمه‌های ترتیب.
    *   `CategoryForm`: مودال ایجاد/ویرایش دسته.
    *   `ItemList`: نمایش آیتم‌های هر دسته.
    *   `ItemForm`: فرم تعریف آیتم، متن پیش‌فرض و زیر‌مجموعه.

### ب) فرم ثبت گزارش (پرستار)
*   **کامپوننت**: `NursingReportForm`
*   **ویژگی‌ها**:
    *   استفاده از `React Hook Form`.
    *   لود کردن دینامیک دسته‌ها و آیتم‌ها از API.
    *   نمایش به صورت آکاردئونی یا تب‌بندی شده بر اساس `Category`.
    *   تولید خودکار متن گزارش (Live Preview) همزمان با تیک زدن آیتم‌ها.

### ج) یکپارچه‌سازی
*   آپدیت `NursingReportsTab` برای نمایش دکمه "ثبت گزارش جدید" که مودال یا صفحه جدید را باز می‌کند.

---

## ۳. مراحل اجرا
1.  **Backend**: ایجاد Entity ها و Migration.
2.  **Backend**: پیاده‌سازی سرویس‌ها و کنترلرهای CRUD.
3.  **Frontend**: پیاده‌سازی صفحه مدیریت دسته‌بندی‌ها (Admin UI).
4.  **Frontend**: پیاده‌سازی فرم ثبت گزارش و منطق تولید متن خودکار.
