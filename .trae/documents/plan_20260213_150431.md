I will upgrade the Medication System to meet the "Clinical-Grade" requirements by enhancing the data model and implementing the requested UI components in both Admin and Nurse panels.

### **Phase 1: Backend Domain Enhancement**

1. **Update Enums (`MedicationEnums.cs`)**

   * Add `MedicationCriticality` (Routine, Important, HighAlert, LifeSaving).

   * Update `DoseStatus` to include `Late`, `Cancelled`, `Due`.
2. **Update Entities (`PatientMedication.cs`)**

   * Add fields: `Form` (Tablet/Injection), `Concentration`, `HighAlert` (bool), `Criticality` (Enum).
3. **Database Migration**

   * Create and apply `UpdateMedicationSchema` migration.
4. **Update Application Layer**

   * Update `MedicationDto` and `CreateMedicationDto` to include new fields.

   * Update `MedicationService` to map and save these fields.

### **Phase 2: Admin Panel Implementation**

1. **Create Medication Tab**

   * Create `frontend/src/components/patients/tabs/MedicationTab.tsx`.

   * Display active medications (Kardex) with badges for High Alert/Criticality.
2. **Create Medication Form**

   * Implement a comprehensive "Add Medication" modal with all clinical fields (Frequency, Route, Criticality, etc.).
3. **Integrate into Patient Detail Page**

   * Add the new tab to `frontend/src/app/dashboard/admin/patients/[id]/page.tsx` between "Vital Signs" and "Services".

### **Phase 3: Nurse Portal Enhancement**

1. **Update Medication Tracker**

   * Enhance `MedicationTracker.tsx` to display Criticality and High Alert flags.

   * Ensure the "Record Dose" action aligns with the updated `DoseStatus` enum.

### **Phase 4: Verification**

1. **End-to-End Test**

   * **Admin**: Add a "High Alert" medication (e.g., Insulin).

   * **Nurse**: Verify it appears in the tracker with the correct warning flag.

   * **Nurse**: Record a dose and verify the status update.

