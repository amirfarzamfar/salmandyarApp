# Intelligent Assessment Engine Implementation Plan

I will implement a comprehensive Assessment Engine to profile Caregivers (Salemandyar/Nurse) and Patients/Elderly for auto-matching.

## Phase 1: Backend Implementation (ASP.NET Core)

### 1. Domain Layer (`Salmandyar.Domain`)
I will create the following entities to support flexible, section-based, and conditional assessments:

*   **Entities**:
    *   `AssessmentTemplate`: The blueprint for an exam (e.g., "Nurse Initial Profile v1"). Supports versioning and roles.
    *   `AssessmentSection`: Logical grouping of questions (e.g., "Medical Skills", "Psychological Profile").
    *   `Question`: The core unit. Properties: `Type` (MultipleChoice, YesNo, Text), `Weight`, `Category`, `ConditionalParentId` (for logic like "If Yes, ask this").
    *   `AssessmentResponse`: Represents a user's attempt. Tracks `Status` (Draft, Completed), `Score`, and timestamps.
    *   `Answer`: Stores the user's response to a specific question.
*   **Enums**: `QuestionType`, `AssessmentStatus`, `QuestionCategory` (Skill, Physical, Psychological, Risk, Preference).

### 2. Infrastructure Layer (`Salmandyar.Infrastructure`)
*   **Database**: Add `DbSet`s for all new entities in `ApplicationDbContext`.
*   **Configuration**: Configure Entity Framework relationships (1-to-Many for Template->Sections->Questions, etc.) and constraints.

### 3. Application Layer (`Salmandyar.Application`)
*   **DTOs**: Create Data Transfer Objects for clean API communication (`AssessmentTemplateDto`, `SubmitAnswerDto`, `AssessmentResultDto`).
*   **Interfaces**: Define `IAssessmentService`.
*   **Implementation**: `AssessmentService` will handle:
    *   Retrieving the active template for a role.
    *   Starting a new assessment (creating a draft).
    *   Saving answers (supporting partial updates/drafts).
    *   **Scoring Engine**: A method to calculate scores per category (e.g., "Skill Score: 80%", "Empathy Score: 90%") to be used by the Matching Engine later.

### 4. API Layer (`Salmandyar.API`)
*   **Controller**: `AssessmentsController` with endpoints:
    *   `GET /templates/{role}`: Get the active assessment for a role.
    *   `POST /start/{templateId}`: Begin an assessment.
    *   `POST /submit-answer`: Save an answer (auto-save).
    *   `POST /complete/{responseId}`: Finalize and calculate score.

## Phase 2: Frontend Implementation (Next.js 14)

### 1. Services & Types
*   **Types**: Define TypeScript interfaces in `src/types/assessment.ts` matching the Backend DTOs.
*   **Service**: Create `src/services/assessment.service.ts` for API integration.

### 2. Components (`src/components/assessment/`)
*   **`AssessmentWizard`**: The main container managing steps (Sections).
*   **`ProgressBar`**: Visual indicator of completion.
*   **`QuestionCard`**: A reusable component that renders different inputs based on `QuestionType` (Radio, Checkbox, Text Area).
*   **`Navigation`**: "Next", "Previous", and "Save Draft" buttons.

### 3. Page (`src/app/assessments/`)
*   **Page**: `[id]/page.tsx` (or similar route) to host the Wizard. It will fetch data on load and handle the user flow.

## Phase 3: Sample Data & Verification
*   **Seeding**: I will create a `DbInitializer` extension to seed a sample "Caregiver Assessment" with sections like "General Info", "Skills", and "Availability".
*   **Verification**: I will verify the flow by starting an assessment, saving a draft, and completing it, checking that the score is calculated.
